{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Renovate configuration for Docker base image template - optimized for 100+ image repositories",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":semanticCommits",
    ":maintainLockFilesWeekly"
  ],
  "timezone": "UTC",
  "schedule": [
    "after 10pm every weekend"
  ],
  "prConcurrentLimit": 5,
  "prHourlyLimit": 0,
  "prCreation": "immediate",
  "rebaseWhen": "conflicted",
  "labels": [
    "dependencies",
    "renovate"
  ],
  "commitMessagePrefix": "chore(deps):",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{#if isPinDigest}}{{{newDigestShort}}}{{else}}{{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}{{/if}}",
  "commitBody": "This automated dependency update is managed by Renovate bot.\n\nSigned-off-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>",
  "addLabels": [],
  "assigneesFromCodeOwners": true,
  "reviewersFromCodeOwners": true,
  "ignoreDeps": [],
  "packageRules": [
    {
      "description": "Docker base images - patch and minor auto-merge for production readiness",
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "patch",
        "minor"
      ],
      "groupName": "Docker base images (non-major)",
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "platformAutomerge": true,
      "minimumReleaseAge": "3 days",
      "internalChecksFilter": "strict",
      "requiredStatusChecks": null
    },
    {
      "description": "Docker major updates - require manual review",
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "major"
      ],
      "groupName": "Docker base images (major)",
      "automerge": false,
      "labels": [
        "dependencies",
        "docker",
        "major-update",
        "requires-review"
      ],
      "reviewers": [
        "team:maintainers"
      ]
    },
    {
      "description": "GitHub Actions - auto-merge all updates with SHA pinning",
      "matchManagers": [
        "github-actions"
      ],
      "groupName": "GitHub Actions",
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "platformAutomerge": true,
      "pinDigests": true,
      "minimumReleaseAge": "1 day",
      "extractVersion": "^(?<version>v\\d+\\.\\d+\\.\\d+)$"
    },
    {
      "description": "GitHub Actions with sub-paths - special handling for digest updates",
      "matchManagers": [
        "github-actions"
      ],
      "matchPackagePatterns": [
        "^github/codeql-action",
        "^siderolabs/conform"
      ],
      "groupName": "GitHub Actions (sub-path)",
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "platformAutomerge": true,
      "pinDigests": false,
      "minimumReleaseAge": "1 day",
      "separateMinorPatch": false
    },
    {
      "description": "Python packages - conservative auto-merge (patch only)",
      "matchManagers": [
        "pip_requirements",
        "pip_setup",
        "pipenv",
        "poetry"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "groupName": "Python ecosystem (patch)",
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "platformAutomerge": true,
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "Python minor/major - manual review for compatibility",
      "matchManagers": [
        "pip_requirements",
        "pip_setup",
        "pipenv",
        "poetry"
      ],
      "matchUpdateTypes": [
        "minor",
        "major"
      ],
      "groupName": "Python ecosystem (minor/major)",
      "automerge": false,
      "labels": [
        "dependencies",
        "python",
        "requires-review"
      ]
    },
    {
      "description": "Security vulnerability updates - immediate auto-merge",
      "matchDatasources": [
        "docker",
        "pypi"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "vulnerabilityAlerts": {
        "enabled": true,
        "labels": [
          "security",
          "priority-high"
        ],
        "automerge": true,
        "schedule": [
          "at any time"
        ]
      }
    },
    {
      "description": "Security scanning tools - always auto-merge",
      "matchPackagePatterns": [
        "^step-security/harden-runner",
        "^github/codeql-action",
        "^ossf/scorecard-action",
        "^aquasecurity/trivy",
        "^anchore/grype"
      ],
      "groupName": "Security tools",
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "minimumReleaseAge": "0 days",
      "schedule": [
        "at any time"
      ]
    },
    {
      "description": "MegaLinter and compliance tools",
      "matchPackagePatterns": [
        "megalinter",
        "oxsecurity/megalinter"
      ],
      "groupName": "Compliance tools",
      "automerge": true,
      "automergeType": "pr",
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "Release automation - requires review",
      "matchPackagePatterns": [
        "release-please",
        "googleapis/release-please"
      ],
      "groupName": "Release automation",
      "automerge": false,
      "labels": [
        "dependencies",
        "automation",
        "requires-review"
      ]
    },
    {
      "description": "Dockerfile linting tools",
      "matchPackagePatterns": [
        "hadolint"
      ],
      "groupName": "Dockerfile linters",
      "automerge": true,
      "automergeType": "pr"
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "schedule": [
      "at any time"
    ]
  },
  "osvVulnerabilityAlerts": true,
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "ü§ñ Renovate Dependency Dashboard",
  "dependencyDashboardHeader": "This dashboard tracks all dependency updates managed by Renovate. PRs will be created automatically based on the schedule and auto-merge rules.",
  "dependencyDashboardFooter": "For questions about specific updates, check the [Renovate documentation](https://docs.renovatebot.com/) or open an issue.",
  "separateMinorPatch": true,
  "separateMajorMinor": true,
  "separateMultipleMajor": true,
  "rangeStrategy": "pin",
  "digest": {
    "enabled": true,
    "automerge": true
  },
  "lockFileMaintenance": {
    "enabled": true,
    "automerge": true,
    "schedule": [
      "before 5am on monday"
    ]
  },
  "dockerfile": {
    "enabled": true,
    "pinDigests": true
  },
  "docker": {
    "enabled": true,
    "pinDigests": true,
    "major": {
      "enabled": true
    },
    "minor": {
      "enabled": true
    },
    "patch": {
      "enabled": true
    }
  },
  "python": {
    "enabled": true
  },
  "pip_requirements": {
    "enabled": true,
    "fileMatch": [
      "(^|/)([\\w-]*)requirements.*\\.txt$",
      "(^|/)requirements/.*\\.txt$"
    ]
  },
  "postUpdateOptions": [
    "gomodTidy",
    "npmDedupe"
  ],
  "ignorePaths": [
    "**/node_modules/**",
    "**/bower_components/**",
    "**/vendor/**",
    "**/__pycache__/**",
    "**/megalinter-reports/**",
    "**/LICENSES/**"
  ],
  "prBodyTemplate": "{{{header}}}{{{table}}}{{{notes}}}{{{changelogs}}}{{{configDescription}}}{{{controls}}}{{{footer}}}",
  "prBodyColumns": [
    "Package",
    "Type",
    "Update",
    "Change",
    "Pending"
  ],
  "prBodyNotes": [
    "‚ö†Ô∏è **Breaking changes** in major updates require manual testing",
    "‚úÖ **Auto-merge** enabled for patch/minor updates after CI passes",
    "üîí **Security updates** are prioritized and merged immediately"
  ]
}
